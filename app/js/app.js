/*!
 * 
 * Angle - Bootstrap Admin App + AngularJS
 * 
 * Author: @themicon_co
 * Website: http://themicon.co
 * License: http://support.wrapbootstrap.com/knowledge_base/topics/usage-licenses
 * 
 */
if("undefined"==typeof $)throw new Error("This application's JavaScript requires jQuery");var App=angular.module("angle",["ngRoute","ngAnimate","ngStorage","ngCookies","pascalprecht.translate","ui.bootstrap","ui.router","oc.lazyLoad","cfp.loadingBar","ngSanitize","ngResource","elasticsearch","btford.socket-io","ui.utils"]).run(["$rootScope","$state","$stateParams","$window","$templateCache","Auth","$location","mySocket",function(e,t,o,n,i,r,a,s){if(e.$state=t,e.$stateParams=o,e.$storage=n.localStorage,e.app={name:"Incidentes",description:"Sistema Gestion de Incidentes",year:(new Date).getFullYear(),layout:{isFixed:!0,isCollapsed:!1,isBoxed:!1,isRTL:!1},viewAnimation:"ng-fadeInUp"},e.$on("$stateChangeStart",function(e,o){"public"===o.module&&r.isLoggin()&&(e.preventDefault(),t.go("app.homeConsultor",null,{notify:!0})),"private"!==o.module||r.isLoggin()||(e.preventDefault(),t.go("login",null,{notify:!0}))}),r.isLoggin()){s.emit("registarUsuario",r.getCurrentUser());var c=r.getCurrentUser();e.user={name:c.nombre,email:c.email,usuarioId:c.usuarioId,picture:c.foto,empresa:c.empresa};var l=JSON.parse(c.rolesMenu);l.indexOf(80)>0?t.go("app.homeSuperConsultor",null,{notify:!0}):l.indexOf(40)>0?t.go("app.homeKu",null,{notify:!0}):t.go("app.homeConsultor",null,{notify:!0})}}]);App.config(["$stateProvider","$urlRouterProvider","$controllerProvider","$compileProvider","$filterProvider","$provide","$ocLazyLoadProvider","APP_REQUIRES","RouteHelpersProvider","$httpProvider",function(e,t,o,n,i,r,a,s,c){"use strict";App.controller=o.register,App.directive=n.directive,App.filter=i.register,App.factory=r.factory,App.service=r.service,App.constant=r.constant,App.value=r.value,a.config({debug:!1,events:!0,modules:s.modules}),e.state("app",{url:"/app","abstract":!0,templateUrl:c.basepath("app.html"),controller:"AppController",resolve:c.resolveFor("modernizr","icons","slimscroll","classyloader","toaster")}).state("app.homeKu",{url:"/home/keyUser",title:"Dashboard",module:"private",templateUrl:c.basepath("home/keyUser.html"),controller:"home.keyUser"}).state("app.homeConsultor",{url:"/home/consultor",title:"Dashboard",module:"private",templateUrl:c.basepath("home/consultor.html"),controller:"home.consultor"}).state("app.homeSuperConsultor",{url:"/home/superConsultor",title:"Dashboard",templateUrl:c.basepath("home/superConsultor.html"),resolve:c.resolveFor("chartjs","flot-chart","flot-chart-plugins"),controller:"home.superConsultor"}).state("app.singleview",{url:"/singleview",title:"Single View",module:"private",templateUrl:c.basepath("singleview.html")}).state("app.submenu",{url:"/submenu",title:"Submenu",templateUrl:c.basepath("submenu.html")}).state("app.crearIncidente",{url:"/incidentes/crearIncidente",templateUrl:c.basepath("incidentes/crearIncidente.html"),module:"private",controller:"incidente.crearIncidente",resolve:c.resolveFor("parsley","angularFileUpload","filestyle","ngDialog")}).state("app.editarIncidenteConsultor",{url:"/incidentes/editarConsultor/:id",templateUrl:c.basepath("incidentes/editarConsultor.html"),module:"private",controller:"incidente.editarConsultor",resolve:c.resolveFor("parsley","angularFileUpload","filestyle","ngDialog")}).state("app.responderKeyUser",{url:"/incidentes/responderKeyUser/:id",templateUrl:c.basepath("incidentes/responderKeyUser.html"),module:"private",controller:"incidente.responderKeyUser",resolve:c.resolveFor("parsley","angularFileUpload","filestyle","ngDialog")}).state("app.verIncidente",{url:"/incidentes/verIncidente/:id",templateUrl:c.basepath("incidentes/ver.html"),module:"private",controller:"incidente.verIncidente",resolve:c.resolveFor("slimscroll")}).state("app.tomarIncidente",{url:"/incidentes/tomarIncidente/:id",templateUrl:c.basepath("incidentes/tomarIncidente.html"),module:"private",controller:"incidente.tomarIncidente"}).state("page",{url:"/page",templateUrl:"app/pages/page.html",module:"private",resolve:c.resolveFor("modernizr","icons","parsley")}).state("login",{url:"/",title:"Login",module:"public",templateUrl:"app/pages/login.html"}).state("app.usuarios",{url:"/administracion/usuarios",title:"Administracion de usuarios",module:"private",controller:"administracion.usuarios",templateUrl:c.basepath("Administracion/usuarios.html")}).state("app.codigoTermino",{url:"/administracion/codigoTermino",title:"Codigos de Termino",module:"private",controller:"administracion.codigoTermino",templateUrl:c.basepath("Administracion/codigoTermino.html")}).state("app.origenProblema",{url:"/administracion/origenProblema",title:"origen Problema",module:"private",controller:"administracion.origenProblema",templateUrl:c.basepath("Administracion/origenProblema.html")}).state("app.tipoIncidente",{url:"/administracion/tipoIncidente",title:"Tipo Sistema",module:"private",controller:"administracion.tipoIncidente",templateUrl:c.basepath("Administracion/tipoIncidente.html")}).state("app.subTipoIncidente",{url:"/administracion/subTipoIncidente",title:"Tipo Sistema",module:"private",controller:"administracion.subTipoIncidente",templateUrl:c.basepath("Administracion/subTipoIncidente.html")})}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"app/i18n/",suffix:".json"}),e.preferredLanguage("en"),e.useLocalStorage()}]).config(["cfpLoadingBarProvider",function(e){e.includeBar=!0,e.includeSpinner=!1,e.latencyThreshold=500,e.parentSelector=".wrapper > section"}]).controller("NullController",function(){}),App.constant("APP_COLORS",{primary:"#5d9cec",success:"#27c24c",info:"#23b7e5",warning:"#ff902b",danger:"#f05050",inverse:"#131e26",green:"#37bc9b",pink:"#f532e5",purple:"#7266ba",dark:"#3a3f51",yellow:"#fad732","gray-darker":"#232735","gray-dark":"#3a3f51",gray:"#dde6e9","gray-light":"#e4eaec","gray-lighter":"#edf1f2"}).constant("APP_MEDIAQUERY",{desktopLG:1200,desktop:992,tablet:768,mobile:480}).constant("APP_REQUIRES",{scripts:{modernizr:["vendor/modernizr/modernizr.js"],chartjs:["vendor/Chart.js/Chart.js"],slimscroll:["vendor/slimScroll/jquery.slimscroll.min.js"],classyloader:["vendor/jquery-classyloader/js/jquery.classyloader.min.js"],icons:["vendor/fontawesome/css/font-awesome.min.css","vendor/simple-line-icons/css/simple-line-icons.css"],parsley:["vendor/parsleyjs/dist/parsley.min.js"],filestyle:["vendor/bootstrap-filestyle/src/bootstrap-filestyle.js"],"flot-chart":["vendor/Flot/jquery.flot.js"],"flot-chart-plugins":["vendor/flot.tooltip/js/jquery.flot.tooltip.min.js","vendor/Flot/jquery.flot.resize.js","vendor/Flot/jquery.flot.pie.js","vendor/Flot/jquery.flot.time.js","vendor/Flot/jquery.flot.categories.js","vendor/flot-spline/js/jquery.flot.spline.min.js","vendor/Flot/jquery.flot.stack.js"]},modules:[{name:"toaster",files:["vendor/angularjs-toaster/toaster.js","vendor/angularjs-toaster/toaster.css"]},{name:"angularFileUpload",files:["vendor/angular-file-upload/angular-file-upload.js"]},{name:"ngDialog",files:["vendor/ngDialog/js/ngDialog.min.js","vendor/ngDialog/css/ngDialog.min.css","vendor/ngDialog/css/ngDialog-theme-default.min.css"]}]}).constant("APP_ANOS",{2015:2015,2016:2016}).constant("APP_MESES",{Enero:1,Febrero:2,Marzo:3,Abril:4,Mayo:5,Junio:6,Julio:7,Agosto:8,Septiembre:9,Octubre:10,Noviembre:11,Diciembre:12}),App.controller("AppController",["$rootScope","$scope","$state","$translate","$window","$localStorage","$timeout","toggleStateService","colors","browser","cfpLoadingBar",function(e,t,o,n,i,r,a,s,c,l,u){"use strict";var d;e.$on("$stateChangeStart",function(){$(".wrapper > section").length&&(d=a(function(){u.start()},0))}),e.$on("$stateChangeSuccess",function(e){e.targetScope.$watch("$viewContentLoaded",function(){a.cancel(d),u.complete()})}),e.$on("$stateNotFound",function(e,t){console.log(t.to),console.log(t.toParams),console.log(t.options)}),e.$on("$stateChangeError",function(e,t,o,n,i,r){console.log(r)}),e.$on("$stateChangeSuccess",function(){i.scrollTo(0,0),e.currTitle=o.current.title}),e.currTitle=o.current.title,e.pageTitle=function(){return e.app.name+" - "+(e.currTitle||e.app.description)},e.$watch("app.layout.isCollapsed",function(t){t===!1&&e.$broadcast("closeSidebarMenu")}),angular.isDefined(r.layout)?t.app.layout=r.layout:r.layout=t.app.layout,e.$watch("app.layout",function(){r.layout=t.app.layout},!0),t.colorByName=c.byName,t.toggleUserBlock=function(){t.$broadcast("toggleUserBlock")},t.miBusqueda="nolose",t.buscar=function(){console.log(t.miBusqueda)},t.language={listIsOpen:!1,available:{en:"English",es_CL:"chileno"},init:function(){var e=n.proposedLanguage()||n.use(),o=n.preferredLanguage();t.language.selected=t.language.available[e||o]},set:function(e){n.use(e),t.language.selected=t.language.available[e],t.language.listIsOpen=!t.language.listIsOpen}},t.language.init(),s.restoreState($(document.body)),a(function(){e.mainViewAnimation=e.app.viewAnimation}),e.cancel=function(e){e.stopPropagation()}}]),App.controller("SidebarController",["$rootScope","$scope","$state","$location","$http","$timeout","APP_MEDIAQUERY",function(e,t,o,n,i,r,a){function s(){return u.width()<a.tablet}function c(){return d.hasClass("aside-collapsed")}var l=e.$state.current.name,u=$(window),d=($("html"),$("body"));e.$on("$stateChangeStart",function(t,o){l=o.name,$("body.aside-toggled").removeClass("aside-toggled"),e.$broadcast("closeSidebarMenu")}),u.on("resize",function(){d.removeClass(s()?"aside-collapsed":"aside-toggled")});var p=function(e){if(e){if(e.sref&&"#"!=e.sref)return o.is(e.sref)||o.includes(e.sref);var t=!1;return angular.forEach(e.submenu,function(e){p(e)&&(t=!0)}),t}};t.getMenuItemPropClasses=function(e){return(e.heading?"nav-heading":"")+(p(e)?" active":"")},t.loadSidebarMenu=function(){var t="/api/usuario/menu/"+e.user.usuarioId,o=t+"?v="+(new Date).getTime();i.get(o).success(function(t){e.menuItems=t}).error(function(){alert("Failure loading menu")})},t.loadSidebarMenu();var m=[];t.addCollapse=function(e,t){m[e]=!p(t)},t.isCollapse=function(e){return m[e]},t.toggleCollapse=function(e,t){function o(e){e+="";for(var t in m)(0>e||e.indexOf(t)<0)&&(m[t]=!0)}return c()&&!s()?!0:(angular.isDefined(m[e])?(m[e]=!m[e],o(e)):t&&o(-1),!0)}}]),App.controller("UserBlockController",["$scope",function(e){e.userBlockVisible=!0,e.$on("toggleUserBlock",function(){e.userBlockVisible=!e.userBlockVisible})}]);var ChartJS=function(e){return{restrict:"A",scope:{data:"=",options:"=",id:"@",width:"=",height:"=",resize:"=",chart:"@",segments:"@",responsive:"=",tooltip:"=",legend:"="},link:function(t,o){var n=o[0].getContext("2d"),i=!1;t.size=function(){t.width<=0?(o.width(o.parent().width()),n.canvas.width=o.width()):(n.canvas.width=t.width||n.canvas.width,i=!0),t.height<=0?(o.height(o.parent().height()),n.canvas.height=n.canvas.width/2):(n.canvas.height=t.height||n.canvas.height,i=!0)},t.$watch("data",function(s){r&&r.destroy(),s&&(t.chart&&(e=t.chart),i&&(t.size(),a=new Chart(n)),(t.responsive||t.resize)&&(t.options.responsive=!0),void 0!==t.responsive&&(t.options.responsive=t.responsive),r=a[e](t.data,t.options),r.update(),t.legend&&angular.element(o[0]).parent().after(r.generateLegend()))},!0),t.$watch("tooltip",function(e){if(r&&r.draw(),void 0!==e&&r.segments&&!(!isFinite(e)||e>=r.segments.length||0>e)){var t=r.segments[e];t.save(),t.fillColor=t.highlightColor,r.showTooltip([t]),t.restore()}},!0),t.size();var r,a=new Chart(n)}}};App.directive("chartjs",function(){return ChartJS()}),App.directive("linechart",function(){return ChartJS("Line")}),App.directive("barchart",function(){return ChartJS("Bar")}),App.directive("radarchart",function(){return ChartJS("Radar")}),App.directive("polarchart",function(){return ChartJS("PolarArea")}),App.directive("piechart",function(){return ChartJS("Pie")}),App.directive("doughnutchart",function(){return ChartJS("Doughnut")}),App.directive("donutchart",function(){return ChartJS("Doughnut")}),App.directive("classyloader",["$timeout","Utils",function(e,t){"use strict";var o=$(window),n="js-is-in-view";return{restrict:"A",link:function(i,r){function a(e,o){var i=-20;!e.hasClass(n)&&t.isInView(e,{topoffset:i})&&s(e,o)}function s(e,t){e.ClassyLoader(t).addClass(n)}e(function(){var e=$(r),t=e.data();t&&(t.triggerInView?(o.scroll(function(){a(e,t)}),a(e,t)):s(e,t))},0)}}}]),App.directive("flot",["$http","$timeout",function(e,t){"use strict";function o(o,n,i){function r(){var e;if(o.dataset&&o.options)return e=$.plot(d,o.dataset,o.options),o.$emit("plotReady",e),o.callback&&o.callback(e,o),e}function a(e){return u?(u.setData(e),u.setupGrid(),u.draw()):(u=r(),s(o.series),u)}function s(e){function t(e){return function(t,n){o[n]&&o[n][e]&&(o[n][e].show=t)}}if(u&&e){var o=u.getData();for(var n in e)angular.forEach(e[n],t(n));u.setData(o),u.draw()}}function c(n){n&&e.get(n).success(function(e){t(function(){o.dataset=e})}).error(function(){$.error("Flot chart: Bad request.")})}var l,u,d,p,m=220;u=null,p=i.width||"100%",l=i.height||m,d=$(n.children()[0]),d.css({width:p,height:l}),o.$watchCollection("dataset",a,!0),o.$watch("series",s,!0),o.$watch("src",c)}return{restrict:"EA",template:"<div></div>",scope:{dataset:"=?",options:"=",series:"=",callback:"=",src:"="},link:o}}]),App.factory("mySocket",["socketFactory",function(e){return e()}]),App.directive("searchOpen",["navSearch",function(e){"use strict";return{restrict:"A",controller:["$scope","$element",function(t,o){o.on("click",function(e){e.stopPropagation()}).on("click",e.toggle)}]}}]).directive("searchDismiss",["navSearch",function(e){"use strict";var t='.navbar-form input[type="text"]';return{restrict:"A",controller:["$scope","$element",function(o,n){$(t).on("click",function(e){e.stopPropagation()}).on("keyup",function(t){27==t.keyCode&&e.dismiss()}),$(document).on("click",e.dismiss),n.on("click",function(e){e.stopPropagation()}).on("click",e.dismiss)}]}}]),App.directive("sidebar",["$window","APP_MEDIAQUERY",function(e,t){function o(e){e.siblings("li").removeClass("open").end().toggleClass("open")}function n(e){i();var t=e.children("ul");if(!t.length)return $();if(e.hasClass("open"))return o(e),$();var n=$(".aside"),r=c.app.layout.isFixed?parseInt(n.css("padding-top"),0):0,a=t.clone().appendTo(n);o(e);var s=e.position().top+r-l.scrollTop(),d=u.height();return a.addClass("nav-floating").css({position:c.app.layout.isFixed?"fixed":"absolute",top:s,bottom:a.outerHeight(!0)+s>d?0:"auto"}),a.on("mouseleave",function(){o(e),a.remove()}),a}function i(){$(".sidebar-subnav.nav-floating").remove()}function r(){return d.hasClass("touch")}function a(){return p.hasClass("aside-collapsed")}function s(){return u.width()<t.tablet}var c,l,u=$(e),d=$("html"),p=$("body");return{restrict:"EA",template:'<nav class="sidebar" ng-transclude></nav>',transclude:!0,replace:!0,link:function(e,t){c=e,l=t;var o=r()?"click":"mouseenter",u=$();l.on(o,".nav > li",function(){a()&&!s()&&(u.trigger("mouseleave"),u=n($(this)))}),e.$on("closeSidebarMenu",function(){i(),$(".sidebar li.open").removeClass("open")})}}}]),App.directive("toggleState",["toggleStateService",function(e){"use strict";return{restrict:"A",link:function(t,o,n){var i=$("body");$(o).on("click",function(t){t.preventDefault();var o=n.toggleState;o&&(i.hasClass(o)?(i.removeClass(o),n.noPersist||e.removeState(o)):(i.addClass(o),n.noPersist||e.addState(o)))})}}}]),App.directive("validateForm",function(){return{restrict:"A",controller:["$scope","$element",function(e,t){var o=$(t);$.fn.parsley&&o.parsley()}]}}),App.service("browser",function(){"use strict";var e,t,o=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],o=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/i.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:o[0]||""}};if(e=o(window.navigator.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version,t.versionNumber=parseInt(e.version)),e.platform&&(t[e.platform]=!0),(t.android||t.ipad||t.iphone||t["windows phone"])&&(t.mobile=!0),(t.cros||t.mac||t.linux||t.win)&&(t.desktop=!0),(t.chrome||t.opr||t.safari)&&(t.webkit=!0),t.rv){var n="msie";e.browser=n,t[n]=!0}if(t.opr){var i="opera";e.browser=i,t[i]=!0}if(t.safari&&t.android){var r="android";e.browser=r,t[r]=!0}return t.name=e.browser,t.platform=e.platform,t}),App.service("ChartData",["$resource",function(e){var t={get:{method:"GET",isArray:!0}};return{load:function(o){return e(o,{},t).get()}}}]),App.factory("colors",["APP_COLORS",function(e){return{byName:function(t){return e[t]||"#fff"}}}]),App.service("navSearch",function(){var e="form.navbar-form";return{toggle:function(){var t=$(e);t.toggleClass("open");var o=t.hasClass("open");t.find("input")[o?"focus":"blur"]()},dismiss:function(){$(e).removeClass("open").find('input[type="text"]').blur().val("")}}}),App.provider("RouteHelpers",["APP_REQUIRES",function(e){"use strict";this.basepath=function(e){return"app/views/"+e},this.resolveFor=function(){var t=arguments;return{deps:["$ocLazyLoad","$q",function(o,n){function i(e){return a.then("function"==typeof e?e:function(){var t=r(e);return t?o.load(t):$.error("Route resolve: Bad resource name ["+e+"]")})}function r(t){if(e.modules)for(var o in e.modules)if(e.modules[o].name&&e.modules[o].name===t)return e.modules[o];return e.scripts&&e.scripts[t]}for(var a=n.when(1),s=0,c=t.length;c>s;s++)a=i(t[s]);return a}]}},this.$get=function(){}}]),App.service("toggleStateService",["$rootScope",function(e){var t="toggleState",o={hasWord:function(e,t){return new RegExp("(^|\\s)"+t+"(\\s|$)").test(e)},addWord:function(e,t){return this.hasWord(e,t)?void 0:e+(e?" ":"")+t},removeWord:function(e,t){return this.hasWord(e,t)?e.replace(new RegExp("(^|\\s)*"+t+"(\\s|$)*","g"),""):void 0}};return{addState:function(n){var i=angular.fromJson(e.$storage[t]);i=i?o.addWord(i,n):n,e.$storage[t]=angular.toJson(i)},removeState:function(n){var i=e.$storage[t];i&&(i=o.removeWord(i,n),e.$storage[t]=angular.toJson(i))},restoreState:function(o){var n=angular.fromJson(e.$storage[t]);n&&o.addClass(n)}}}]),App.service("Utils",["$window","APP_MEDIAQUERY",function(e,t){"use strict";var o=angular.element("html"),n=angular.element(e),i=angular.element("body");return{support:{transition:function(){var e=function(){var e,t=document.body||document.documentElement,o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in o)if(void 0!==t.style[e])return o[e]}();return e&&{end:e}}(),animation:function(){var e=function(){var e,t=document.body||document.documentElement,o={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(e in o)if(void 0!==t.style[e])return o[e]}();return e&&{end:e}}(),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},touch:"ontouchstart"in window&&navigator.userAgent.toLowerCase().match(/mobile|tablet/)||window.DocumentTouch&&document instanceof window.DocumentTouch||window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>0||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>0||!1,mutationobserver:window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||null},isInView:function(e,t){var o=$(e);if(!o.is(":visible"))return!1;var i=n.scrollLeft(),r=n.scrollTop(),a=o.offset(),s=a.left,c=a.top;return t=$.extend({topoffset:0,leftoffset:0},t),c+o.height()>=r&&c-t.topoffset<=r+n.height()&&s+o.width()>=i&&s-t.leftoffset<=i+n.width()?!0:!1},langdirection:"rtl"==o.attr("dir")?"right":"left",isTouch:function(){return o.hasClass("touch")},isSidebarCollapsed:function(){return i.hasClass("aside-collapsed")},isSidebarToggled:function(){return i.hasClass("aside-toggled")},isMobile:function(){return n.width()<t.tablet}}}]);var myApp=angular.module("myAppName",["angle"]);myApp.run(["$log",function(e){e.log("I'm a line from custom.js")}]),myApp.config(["RouteHelpersProvider",function(){}]),myApp.controller("oneOfMyOwnController",["$scope",function(){}]),myApp.directive("oneOfMyOwnDirectives",function(){}),myApp.config(["$stateProvider",function(){}]),App.controller("administracion.codigoTermino",["$scope","Auth","$http","toaster",function(e,t,o,n){e.codigoTermino={},e.listas={},e.listas.estado=[],e.habilitarGrabar=-1,e.listas.estado.push({id:1,nombre:"Activo"}),e.listas.estado.push({id:0,nombre:"Inactivo"}),o.get("/api/administracion/listarCodigotermino").success(function(t){e.data=t}),e.seleccionar=function(t){e.codigoTermino.id=t.CodigoTerminoId,e.codigoTermino.estado=t.EsActivo,e.codigoTermino.nombre=t.Nombre,e.habilitarGrabar=0},e.nuevoRegistro=function(){e.codigoTermino.id=0,e.codigoTermino.estado=1,e.codigoTermino.nombre="",e.habilitarGrabar=1},e.prueba=function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),console.log(n)},e.actualizarRegistro=function(){o.post("/api/administracion/codigoTermino/update",{codigoTermino:e.codigoTermino}).success(function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),e.codigoTermino.id=0,e.codigoTermino.estado=1,e.codigoTermino.nombre="",e.habilitarGrabar=-1,o.get("/api/administracion/listarCodigotermino").success(function(t){e.data=t})}).error(function(){})},e.crearRegistro=function(){o.post("/api/administracion/codigoTermino/insert",{codigoTermino:e.codigoTermino}).success(function(){n.pop("success","Registro Creado","Se actualiza correctamente el registro"),e.codigoTermino.id=0,e.codigoTermino.estado=1,e.codigoTermino.nombre="",e.habilitarGrabar=-1,o.get("/api/administracion/listarCodigotermino").success(function(t){e.data=t})}).error(function(){})}}]),App.controller("administracion.origenProblema",["$scope","Auth","$http","toaster",function(e,t,o,n){e.origenProblema={},e.listas={},e.listas.estado=[],e.habilitarGrabar=-1,e.listas.estado.push({id:1,nombre:"Activo"}),e.listas.estado.push({id:0,nombre:"Inactivo"}),o.get("/api/administracion/origenProblema/listar").success(function(t){e.data=t}),e.seleccionar=function(t){e.origenProblema.id=t.OrigenProblemaId,e.origenProblema.estado=t.EsActivo,e.origenProblema.nombre=t.Nombre,e.habilitarGrabar=0},e.nuevoRegistro=function(){e.origenProblema.id=0,e.origenProblema.estado=1,e.origenProblema.nombre="",e.habilitarGrabar=1},e.prueba=function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),console.log(n)},e.actualizarRegistro=function(){o.post("/api/administracion/origenProblema/update",{origenProblema:e.origenProblema}).success(function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),e.origenProblema.id=0,e.origenProblema.estado=1,e.origenProblema.nombre="",e.habilitarGrabar=-1,o.get("/api/administracion/origenProblema/listar").success(function(t){e.data=t})}).error(function(){})},e.crearRegistro=function(){o.post("/api/administracion/origenProblema/insert",{origenProblema:e.origenProblema}).success(function(){n.pop("success","Registro Creado","Se actualiza correctamente el registro"),e.origenProblema.id=0,e.origenProblema.estado=1,e.origenProblema.nombre="",e.habilitarGrabar=-1,o.get("/api/administracion/origenProblema/listar").success(function(t){e.data=t})}).error(function(){})}}]),App.controller("administracion.subTipoIncidente",["$scope","Auth","$http","toaster",function(e,t,o,n){e.subTipoIncidente={},e.listas={},e.listas.estado=[],e.habilitarGrabar=-1,e.listas.estado.push({id:1,nombre:"Activo"}),e.listas.estado.push({id:0,nombre:"Inactivo"}),o.get("/api/administracion/subTipoIncidente/listar").success(function(t){e.data=t}),o.get("/api/listas/incidente/tipoInicidente").success(function(t){e.listas.sistema=t}),e.seleccionar=function(t){e.subTipoIncidente.id=t.SubTipoIncidenteId,e.subTipoIncidente.estado=t.EsActivo,e.subTipoIncidente.nombre=t.Nombre,e.subTipoIncidente.TipoIncidenteId=t.TipoIncidenteId,console.log(t.TipoIncidenteId),e.habilitarGrabar=0},e.nuevoRegistro=function(){e.subTipoIncidente.id=0,e.subTipoIncidente.estado=1,e.subTipoIncidente.nombre="",e.subTipoIncidente.TipoIncidenteId=-1,e.habilitarGrabar=1},e.prueba=function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),console.log(n)},e.actualizarRegistro=function(){o.post("/api/administracion/subTipoIncidente/update",{subTipoIncidente:e.subTipoIncidente}).success(function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),e.subTipoIncidente.id=0,e.subTipoIncidente.estado=1,e.subTipoIncidente.nombre="",e.subTipoIncidente.TipoIncidenteId="",e.habilitarGrabar=-1,o.get("/api/administracion/subTipoIncidente/listar").success(function(t){e.data=t})}).error(function(){})},e.crearRegistro=function(){o.post("/api/administracion/subTipoIncidente/insert",{subTipoIncidente:e.subTipoIncidente}).success(function(){n.pop("success","Registro Creado","Se actualiza correctamente el registro"),e.subTipoIncidente.id=0,e.subTipoIncidente.estado=1,e.subTipoIncidente.nombre="",e.subTipoIncidente.TipoIncidenteId=-1,e.habilitarGrabar=-1,o.get("/api/administracion/subTipoIncidente/listar").success(function(t){e.data=t})}).error(function(){})}}]),App.controller("administracion.tipoIncidente",["$scope","Auth","$http","toaster",function(e,t,o,n){e.tipoIncidente={},e.listas={},e.listas.estado=[],e.habilitarGrabar=-1,e.listas.estado.push({id:1,nombre:"Activo"}),e.listas.estado.push({id:0,nombre:"Inactivo"}),o.get("/api/administracion/tipoIncidente/listar").success(function(t){e.data=t}),e.seleccionar=function(t){e.tipoIncidente.id=t.TipoIncidenteId,e.tipoIncidente.estado=t.EsActivo,e.tipoIncidente.nombre=t.Nombre,e.tipoIncidente.sla=t.sla,e.habilitarGrabar=0},e.nuevoRegistro=function(){e.tipoIncidente.id=0,e.tipoIncidente.estado=1,e.tipoIncidente.nombre="",e.habilitarGrabar=1},e.prueba=function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),console.log(n)},e.actualizarRegistro=function(){o.post("/api/administracion/tipoIncidente/update",{tipoIncidente:e.tipoIncidente}).success(function(){n.pop("success","Registro Actualizado","Se actualiza correctamente el registro"),e.tipoIncidente.id=0,e.tipoIncidente.estado=1,e.tipoIncidente.nombre="",e.tipoIncidente.sla="",e.habilitarGrabar=-1,o.get("/api/administracion/tipoIncidente/listar").success(function(t){e.data=t})}).error(function(){})},e.crearRegistro=function(){o.post("/api/administracion/tipoIncidente/insert",{tipoIncidente:e.tipoIncidente}).success(function(){n.pop("success","Registro Creado","Se actualiza correctamente el registro"),e.tipoIncidente.id=0,e.tipoIncidente.estado=1,e.tipoIncidente.nombre="",e.habilitarGrabar=-1,o.get("/api/administracion/tipoIncidente/listar").success(function(t){e.data=t})}).error(function(){})}}]),App.controller("administracion.usuarios",["$scope","Auth","elasticFactory","$http",function(e,t,o,n){function i(){for(var t=[],o=0;o<=e.roles.length-1;o++)1==e.arrayRoles[e.roles[o].rolId]&&t.push(e.roles[o].rolId);return t}e.idEmail="",e.nombre="",e.mensajeExito=!1,e.usuarioId=0,e.activarBoton=!1,e.arrayRoles={},n.get("/api/listas/listarRoles").success(function(t){e.roles=t}),e.seleccionarUsuario=function(){o.get({index:"contactos",type:"kcc",id:e.idEmail[0]},function(t,o){e.activarBoton=!0,e.arrayRoles={},e.nombre=o._source.nombre,e.email=o._source.email,e.rut=o._source.rut,e.cargo=o._source.cargo,e.rutEmpresa=o._source.rutEmpresa.trim(),e.empresa=o._source.empresa,n.get("/api/usuario/"+o._source.email).success(function(t){if(void 0!=t){e.usuarioId=t.usuarioId;for(var o=JSON.parse(t.rolesMenu),n=0;n<=o.length-1;n++)e.arrayRoles[o[n]]=!0}})})},e.actualizarUsuario=function(){var t={};console.log("aca si "),t.nombre=e.nombre,t.email=e.email,t.usuarioId=e.usuarioId,t.fechaCreacion=new Date,t.fechaActualizacion=new Date,t.fechaUltLogin=new Date,t.rolesMenu=i(),t.estado=1,t.rutEmpresa=e.rutEmpresa,e.usuarioId>0?n.post("/api/usuario/update",{usuario:t}).success(function(){e.mensajeExito=!0}).error(function(){}):n.post("/api/usuario",{usuario:t}).success(function(){}).error(function(){})}}]),App.controller("home.consultor",["$scope","$http","Auth","$filter",function(e,t,o,n){"use strict";e.dashboard={},e.miFiltro={},e.getCurrentUser=o.getCurrentUser(),e.filtroAsignado=function(t){return t.idUsuarioConsultor==e.getCurrentUser.usuarioId},e.filtroSinAsignar=function(e){return-1==e.idUsuarioConsultor},e.filtroDevolucion=function(e){return 70==e.idEstado},e.filtroPendiente=function(e){return 30==e.idEstado||60==e.idEstado},e.filtroFueraSLA=function(e){return e.tiempoTranscurrido>e.sla},e.cargarFiltro=function(t){switch(t){case 1:e.miFiltro=e.filtroAsignado;break;case 2:e.miFiltro=e.filtroSinAsignar;break;case 3:e.miFiltro=e.filtroDevolucion;break;case 4:e.miFiltro=e.filtroFueraSLA;break;default:e.miFiltro=e.filtroAsignado}},e.cargarFiltro(1),t.get("/api/incidente/listarConsultor/"+e.getCurrentUser.usuarioId).success(function(t){e.data=t,e.dashboard.misCasos=n("filter")(e.data,e.filtroAsignado).length,e.dashboard.sinAsignar=n("filter")(e.data,e.filtroSinAsignar).length,e.dashboard.devolucion=n("filter")(e.data,e.filtroDevolucion).length,e.dashboard.fueraSLA=n("filter")(e.data,e.filtroFueraSLA).length})}]),App.controller("home.keyUser",["$scope","$http","Auth","$filter",function(e,t,o,n){"use strict";e.dashboard={},e.miFiltro={},e.getCurrentUser=o.getCurrentUser(),e.filtroAsignado=function(e){return e.idUsuarioConsultor>-1},e.filtroPendiente=function(e){return 30==e.idEstado||60==e.idEstado},e.cargarFiltro=function(t){switch(t){case 1:e.miFiltro={};break;case 2:e.miFiltro=e.filtroPendiente;break;case 3:e.miFiltro=e.filtroAsignado}},t.get("/api/incidente/listarKU/"+e.getCurrentUser.usuarioId).success(function(t){e.data=t,e.dashboard.asignado=n("filter")(e.data,e.filtroAsignado).length,e.dashboard.pendiente=n("filter")(e.data,e.filtroPendiente).length,e.dashboard.misCasos=t.length})}]),App.controller("home.superConsultor",["$scope","$http","Auth","$filter","colors","ChartData",function(e,t,o,n,i,r){"use strict";e.dashboard={},e.miFiltro={},e.getCurrentUser=o.getCurrentUser(),e.listas={},e.anno=[{nombre:"2015",id:2015}],e.meses=[{mes:"Enero",id:1},{mes:"Febrero",id:2},{mes:"Marzo",id:3},{mes:"Abril",id:4},{mes:"Mayo",id:5},{mes:"Junio",id:6},{mes:"Julio",id:7},{mes:"Agosto",id:8},{mes:"Septiembre",id:9},{mes:"Octubre",id:10},{mes:"Noviembre",id:11},{mes:"Diciembre",id:12}],t.get("/api/listas/empresa").success(function(t){e.listas.empresa=t});var a=new Date;e.dashboard.mes=a.getMonth(),e.dashboard.anno=a.getFullYear(),e.dashboard.idEmpresa=-1,t.get("/api/incidente/estatusActual").success(function(t){e.dashboard.online=t}),e.datos={mes:e.dashboard.mes,anno:e.dashboard.anno,idEmpresa:e.dashboard.idEmpresa},t.post("/api/incidente/dashboard/porcentajeCumplimiento/",e.datos).success(function(t){e.dashboard.porcentajeMes=t.detalleCasos,e.dashboard.totalArea=[];var o={};o.totalCasos=t.totalCasos,o.porcentajeCumplimiento=parseInt(t.porcentajeCumplimiento),o.totalCumpleSLA=t.cumpleSLA,e.dashboard.totalArea.push(o)}),t.post("/api/incidente/dashboard/incidentesKeyUser/",e.datos).success(function(t){e.dashboard.incidentesKeyUser=t}),t.post("/api/incidente/dashboard/incidentesPorSistema/",e.datos).success(function(t){console.log("sdsd");for(var o=[],n=[],r=[],a=0;a<=t.length-1;a++)n.push(t[a].tipoincidente.Nombre),r.push(t[a].count);o.labels=n,o.datasets=[],o.datasets.push({fillColor:i.byName("info"),strokeColor:i.byName("info"),highlightFill:i.byName("info"),highlightStroke:i.byName("info"),data:r}),e.dashboard.incidentesPorSistema=o,console.log(e.dashboard.incidentesPorSistema)}),t.post("/api/incidente/dashboard/incidentesPorOrigenProblema/",e.datos).success(function(t){for(var o=[],n=1;n<=t.length-1;n++)o.push(t[n]);
console.log(o),e.barStackeData=o,e.barStackeData2=r.load("server/barstacked.json")}),e.actualizarDashboard=function(){e.datos={mes:e.dashboard.mes,anno:e.dashboard.anno,idEmpresa:e.dashboard.idEmpresa},t.post("/api/incidente/dashboard/incidentesKeyUser/",e.datos).success(function(t){e.dashboard.incidentesKeyUser=t}),t.post("/api/incidente/dashboard/incidentesPorOrigenProblema/",e.datos).success(function(t){for(var o=[],n=1;n<=t.length-1;n++)o.push(t[n]);console.log(o),e.barStackeData=o}),t.post("/api/incidente/dashboard/porcentajeCumplimiento/",e.datos).success(function(t){e.dashboard.porcentajeMes=t.detalleCasos,e.dashboard.totalArea=[];var o={};o.totalCasos=t.totalCasos,o.porcentajeCumplimiento=parseInt(t.porcentajeCumplimiento),o.totalCumpleSLA=t.cumpleSLA,e.dashboard.totalArea.push(o)}),t.post("/api/incidente/dashboard/incidentesPorSistema/",e.datos).success(function(t){console.log("sdsd");for(var o=[],n=[],r=[],a=0;a<=t.length-1;a++)n.push(t[a].tipoincidente.Nombre),r.push(t[a].count);o.labels=n,o.datasets=[],o.datasets.push({fillColor:i.byName("info"),strokeColor:i.byName("info"),highlightFill:i.byName("info"),highlightStroke:i.byName("info"),data:r}),e.dashboard.incidentesPorSistema=o,console.log(e.dashboard.incidentesPorSistema)})},e.barStackedOptions={series:{stack:!0,bars:{align:"center",lineWidth:0,show:!0,barWidth:.3,fill:.4}},grid:{borderColor:"#eee",borderWidth:1,hoverable:!0,backgroundColor:"#fcfcfc"},tooltip:!0,tooltipOpts:{content:function(e,t,o){return o+" : "+t}},xaxis:{tickColor:"#fcfcfc",mode:"categories"},yaxis:{min:0,position:e.app.layout.isRTL?"right":"left",tickColor:"#eee"},shadowSize:0},e.barOptions={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1}}]),App.controller("incidente.crearIncidente",["$scope","Auth","$http","FileUploader","ngDialog","$state",function(e,t,o,n,i,r){e.incidente={},e.listas={},e.getCurrentUser=t.getCurrentUser();var a=e.uploader=new n({url:"/api/adjunto/subir"});e.cerrarPagina=function(){r.go("app.homeKu",null,{notify:!0})},a.onBeforeUploadItem=function(t){var o=[{IncidenteId:e.IncidenteId}];Array.prototype.push.apply(t.formData,o)},a.onSuccessItem=function(e,t,o,n){console.info("onSuccessItem",e,t,o,n)},a.onCompleteAll=function(){e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm()},o.get("/api/listas/incidente/tipoInicidente").success(function(t){e.listas.sistema=t}),e.cargaModulo=function(){o.get("/api/listas/incidente/subTipoInicidente/"+e.incidente.idTipoIncidente).success(function(t){e.listas.modulo=t})},e.grabarIncidente=function(){e.paginaValida=!e.formCrearIncidente.$error.required,e.paginaValida&&(e.incidente.usuario=e.getCurrentUser.email,e.incidente.IdInterno=e.IncidenteId,e.incidente.usuario=e.getCurrentUser,o.post("/api/incidente/",e.incidente).success(function(t){e.IncidenteId=t.idIncidente,console.log(t),0==a.queue.length?e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm():a.uploadAll()}),e.esgrabado=!0)},e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm=function(){i.openConfirm({template:"dialogWithNestedConfirmDialogId",className:"ngdialog-theme-default",preCloseCallback:function(){var t=i.openConfirm({template:'<p>Are you sure you want to close the parent dialog?</p><div><button type="button" class="btn btn-default" ng-click="closeThisDialog(0)">No<button type="button" class="btn btn-primary" ng-click="confirm(1)">Yes</button></div>',plain:!0,className:"ngdialog-theme-default"}).then(function(){e.cerrarPagina()});return t},scope:e}).then(function(){e.cerrarPagina()},function(){e.cerrarPagina()})}}]),App.controller("incidente.editarConsultor",["$scope","Auth","$http","$stateParams","FileUploader","ngDialog","$state",function(e,t,o,n,i,r,a){e.incidente={},e.listas={},e.getCurrentUser=t.getCurrentUser();var s=e.uploader=new i({url:"/api/adjunto/subir"});s.onBeforeUploadItem=function(t){var o=[{IncidenteId:e.incidente.idIncidente}];Array.prototype.push.apply(t.formData,o)},s.onSuccessItem=function(e,t,o,n){console.info("onSuccessItem",e,t,o,n)},s.onCompleteAll=function(){e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm()},o.get("/api/incidente/"+n.id).success(function(t){e.incidente=t,o.get("/api/listas/incidente/estadosPermitidos/"+e.incidente.idEstado).success(function(t){e.listas.estados=t}),o.get("/api/listas/incidente/codigoTermino").success(function(t){e.listas.codigoTermino=t}),o.get("/api/listas/incidente/origenProblema").success(function(t){e.listas.origenProblema=t}),o.get("/api/listas/incidente/subTipoInicidente/"+e.incidente.idTipoIncidente).success(function(t){e.listas.modulo=t}),o.get("/api/listas/listarConsultores").success(function(t){e.listas.consultor=t})}),e.guardar=function(){e.paginaValida=!e.formCrearIncidente.$error.required,console.log(e.formCrearIncidente.$error),e.paginaValida&&(e.incidente.usuario=t.getCurrentUser(),o.post("/api/incidente/guardarIncidente",e.incidente).success(function(){0==s.queue.length?e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm():s.uploadAll()}))},e.cerrarPagina=function(){a.go("app.homeConsultor",null,{notify:!0})},e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm=function(){r.openConfirm({template:"dialogWithNestedConfirmDialogId2",className:"ngdialog-theme-default",preCloseCallback:function(){var t=r.openConfirm({template:'<p>estas seguro que quieres cerrar esta pagina?</p><div><button type="button" class="btn btn-default" ng-click="closeThisDialog(0)">No<button type="button" class="btn btn-primary" ng-click="confirm(1)">Yes</button></div>',plain:!0,className:"ngdialog-theme-default"}).then(function(){e.cerrarPagina()});return t},scope:e}).then(function(){e.cerrarPagina()},function(){e.cerrarPagina()})}}]),App.controller("incidente.responderKeyUser",["$scope","Auth","$http","$stateParams","FileUploader","ngDialog","$state",function(e,t,o,n,i,r,a){e.incidente={},e.listas={},e.getCurrentUser=t.getCurrentUser();var s=e.uploader=new i({url:"/api/adjunto/subir"});s.onBeforeUploadItem=function(t){var o=[{IncidenteId:e.incidente.idIncidente}];Array.prototype.push.apply(t.formData,o)},s.onSuccessItem=function(e,t,o,n){console.info("onSuccessItem",e,t,o,n)},s.onCompleteAll=function(){e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm()},o.get("/api/incidente/"+n.id).success(function(t){e.incidente=t,o.get("/api/listas/incidente/estadosPermitidos/"+e.incidente.idEstado).success(function(t){e.listas.estados=t})}),e.guardar=function(){e.paginaValida=!e.formResponderKeyUserIncidente.$error.required,console.log(e.formResponderKeyUserIncidente.$error),e.paginaValida&&(e.incidente.usuario=t.getCurrentUser(),o.post("/api/incidente/guardarIncidente",e.incidente).success(function(){0==s.queue.length?e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm():s.uploadAll()}))},e.cerrarPagina=function(){a.go("app.homeKu",null,{notify:!0})},e.openConfirmWithPreCloseCallbackInlinedWithNestedConfirm=function(){r.openConfirm({template:"dialogWithNestedConfirmDialogId2",className:"ngdialog-theme-default",preCloseCallback:function(){var t=r.openConfirm({template:'<p>estas seguro que quieres cerrar esta pagina?</p><div><button type="button" class="btn btn-default" ng-click="closeThisDialog(0)">No<button type="button" class="btn btn-primary" ng-click="confirm(1)">Yes</button></div>',plain:!0,className:"ngdialog-theme-default"}).then(function(){e.cerrarPagina()});return t},scope:e}).then(function(){e.cerrarPagina()},function(){e.cerrarPagina()})}}]),App.controller("incidente.tomarIncidente",["$scope","Auth","$http","$stateParams","$state",function(e,t,o,n,i){e.incidente={},e.listas={},e.getCurrentUser=t.getCurrentUser(),o.get("/api/incidente/"+n.id).success(function(t){e.incidente=t}),e.tomarIncidente=function(n){confirm("¿Está seguro que desea tomar el incidente? "+n)&&(e.getCurrentUser=t.getCurrentUser(),e.incidente.usuario=e.getCurrentUser.usuarioId,o.post("/api/incidente/tomarIncidente",e.incidente).success(function(){i.go("app.editarIncidenteConsultor",{id:e.incidente.idIncidente},{notify:!0})}))}}]),App.controller("incidente.verIncidente",["$scope","Auth","$http","$stateParams",function(e,t,o,n){e.incidente={},e.listas={},e.getCurrentUser=t.getCurrentUser(),o.get("/api/incidente/"+n.id).success(function(t){e.incidente=t})}]),App.controller("loginController",["$scope","$state","$window","Auth",function(e,t,o){e.loginOauth=function(e){o.location.href="/auth/"+e}}]),App.factory("Auth",["$location","$rootScope","$http","$cookieStore","$q",function(e,t,o,n){var i={};return n.get("token")&&(i=n.get("user")),{logout:function(){n.remove("token"),n.remove("user")},getCurrentUser:function(){return i},isLoggin:function(){return n.get("token")?!0:!1}}}]).factory("authInterceptor",["$rootScope","$q","$cookieStore","$location",function(e,t,o,n){return{request:function(e){return e.headers=e.headers||{},o.get("token")&&(e.headers.Authorization="Bearer "+o.get("token")),e},responseError:function(e){return 401===e.status?(n.path("/login"),o.remove("token"),o.remove("user"),t.reject(e)):t.reject(e)}}}]),App.directive("scrollable",function(){return{restrict:"EA",link:function(e,t,o){var n=250;t.slimScroll({height:o.height||n})}}}),App.factory("elasticFactory",["esFactory",function(e){return e({host:"54.187.191.158",header:""})}]),App.directive("typeah2ead",["elasticFactory","$timeout",function(e,t){return{restrict:"AEC",scope:{items:"=",prompt:"@",nombre:"@",cargo:"@",codigo:"=",model:"=",onSelect:"&"},link:function(o){o.handleSelection=function(e,n){o.current=0,o.selected=!0,o.codigo=e,o.model=n,t(function(){o.onSelect(e)},200)},o.current=0,o.selected=!0,o.isCurrent=function(e){return o.current==e},o.autocomplete=function(){void 0!=o.model&&o.model.length>2&&e.search({index:"contactos",size:15,body:{fields:["nombre","cargo","email"],query:{multi_match:{query:o.model,fields:["nombre^2","cargo"]}}}}).then(function(e){o.items=e.hits.hits})},o.setCurrent=function(e){o.current=e}},templateUrl:"app/views/partials/autocomplete.html"}}]);